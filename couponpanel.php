<?php
/**
 * Plugin Name: CouponPanel
 * Plugin URI: https://www.feeds4.com/couponpanel/
 * Description: Bring the revenue generating power of coupons to your Wordpress website.  CouponPanel allows Wordpress websites to add fully automated coupon pages to any Wordpress page or post.
 * Author: Feeds4.com
 * Version: 1.7.0
 * License: GPL2+
**/
if ( !defined( 'ABSPATH' ) ) { die(); }  function cpnl_a_h() {  $cpnl_o = get_option('cpnl_o');  $cpnl_o['cpnl_b_u'] = 'https://api.feeds4.com'; $cpnl_o['cpnl_b_v'] = 'v3'; $cpnl_o['cpnl_b_d'] = 'plugins'; $cpnl_o['cpnl_b_p'] = 'couponpanel'; $cpnl_o['cpnl_v'] 	= '1.7.0';  $cpnl_o['cpnl_n'] 	= 'CouponPanel';  update_option('cpnl_o', $cpnl_o);  cpnl_d_t_k();  } register_activation_hook( plugin_basename(__FILE__), 'cpnl_a_h' );  function cpnl_d_h() {  delete_option("cpnl_o");  cpnl_d_t_k();  } register_deactivation_hook( plugin_basename(__FILE__),  'cpnl_d_h' );  function cpnl_a_n($msg, $class='updated') {  echo '<div class="'.esc_attr($class).' fade" style="margin-left: 2px;"><p></b>'.esc_html($msg).'</b></p></div>'; }  function cpnl_s_l($links, $file) {  static $this_plugin;  if (!$this_plugin) { $this_plugin = plugin_basename(__FILE__); }  if ($file == $this_plugin) { $sl = '<a href="/wp-admin/admin.php?page=cpnl_admin">Settings</a>'; array_unshift($links, $sl); }  return $links; } add_filter('plugin_action_links', 'cpnl_s_l', 10, 2);  function cpnl_a_t($t, $c=null) {  $tab = ''; $u = '';  if ( is_null($c) ) { $c = 'token'; }  if ( isset($_GET['tab']) ) { $c = cpnl_v_t($_GET['tab']); }  foreach ($t as $k => $v) {  $u = '?page=cpnl_admin&tab='.$k;  if ($c == $k) { $css = 'nav-tab nav-tab-active'; } else { $css = 'nav-tab'; }  $tab = $tab.'<a class="'.esc_attr($css).'" href="'.esc_url_raw($u).'">'.esc_html($v).'</a>'; }  return '<h2 class="nav-tab-wrapper">'.$tab.'</h2>';  }  function cpnl_v_t($t) {  $d = 'token';  $ta = array('token','settings','layout','style','shortcode');  if ( in_array($t, $ta) ) { $d = $t; }  return $d;  }  function cpnl_d_t_k() {  delete_transient('cpnl_t_k'); return;  }  function cpnl_m() {  $cpnl_o = get_option('cpnl_o'); $cpnl_n = $cpnl_o['cpnl_n'];  add_menu_page( $cpnl_n.' Admin Page', $cpnl_n, 'manage_options', 'cpnl_admin', 'cpnl_a_p', 'dashicons-welcome-widgets-menus', 2  ); } add_action( 'admin_menu', 'cpnl_m' );  function cpnl_w_es() {  wp_enqueue_style('cpnl-bs-css', plugins_url('/css/bootstrap.min.css', __FILE__)); wp_enqueue_style('cpnl-css', plugins_url('/css/cpnl.css', __FILE__)); wp_enqueue_script('cpnl-bs-js', plugins_url('/js/bootstrap.min.js', __FILE__), array('jquery'), false, true);  wp_enqueue_script('cpnl-a-s', plugins_url('/js/cpnl-js.js', __FILE__), array( 'jquery' ), false, true); wp_localize_script( 'cpnl-a-s', 'cpnl_a_u', array( 'ajaxurl' => admin_url( 'admin-ajax.php' ) ) );  } add_action('wp_enqueue_scripts', 'cpnl_w_es');  function cpnl_a_es( $hook ) {  if ( $hook != 'toplevel_page_cpnl_admin' ) { return; }  wp_enqueue_style('cpnl-css', plugins_url('/css/cpnl.css', __FILE__)); wp_enqueue_style( 'f4-css-bs', plugins_url( '/css/bootstrap-grid.min.css',  __FILE__) ); wp_enqueue_script('cpnl-wpcp', plugins_url('/js/cpnl-wpcp.js', __FILE__), array('jquery','wp-color-picker'), null, true); wp_enqueue_script('cpnl-a-js', plugins_url('/js/cpnl-admin-js.js', __FILE__), array('jquery'), false, true);  } add_action('admin_enqueue_scripts', 'cpnl_a_es');  function cpnl_v_c_i($cpnl_c) {  $cid = '0';  $cpnl_c = empty($cpnl_c) ? '' : $cpnl_c;  if (!$cpnl_c) { return $cid; }  $d = empty(get_transient('cpnl_t_k')) ? '' : get_transient('cpnl_t_k');  if (!$d) { return $cid; }  $c = empty($d['c']) ? '' : $d['c'];  if (!$c) { return $cid; }  foreach($c as $ci) {  if (stripos($ci, "?cid=".$cpnl_c) !== false) {  $cid = $cpnl_c; break;  } }  return $cid;  }  function cpnl_v_m_i($cpnl_m) {  $mid = '0';  $cpnl_m = empty($cpnl_m) ? '' : $cpnl_m;  if (!$cpnl_m) { return $mid; }  $d = empty(get_transient('cpnl_t_k')) ? '' : get_transient('cpnl_t_k');  if (!$d) { return $mid; }  $c = empty($d['c']) ? '' : $d['c'];  if (!$c) { return $mid; }  foreach($c as $ci) {  if (stripos($ci, "?mid=".$cpnl_m) !== false) {  $mid = $cpnl_m; break;  } }  return $mid; }  function cpnl_c_sc($atts) {  $sa = shortcode_atts( array( 'merchant' => '', 'subid' => '', 'image' => '', ), $atts );  $cpnl_m_sc_a = empty($sa["merchant"]) ? '' : $sa["merchant"];  $cpnl_s_sc_a = empty($sa["subid"]) ? '' : $sa["subid"];  $cpnl_i_sc_a = empty($sa["image"]) ? '' : $sa["image"];  return cpnl_w_c_f($cpnl_m_sc_a, $cpnl_s_sc_a, $cpnl_i_sc_a);  } add_shortcode('couponpanel','cpnl_c_sc');  function cpnl_i_w() {  register_widget('cpnl_w');  } add_action('widgets_init','cpnl_i_w');  class cpnl_w extends WP_Widget {  function __construct() {  $cpnl_o = get_option('cpnl_o'); $cpnl_n = $cpnl_o['cpnl_n'];  parent::__construct( 'cpnl_w', __( $cpnl_n .' Sidebar Merchant List', 'cpnl_wd' ), array( 'description' => __( 'Displays a list of merchant anchor links for your coupons.', 'cpnl_wd' ), ) ); }  public function widget( $args, $instance ) {  $cpnl_o = get_option('cpnl_o');  $postid = get_the_ID(); $post = get_post($postid);  if ( has_shortcode( $post->post_content, 'couponpanel' ) ) {  $title = apply_filters( 'widget_title', $instance['title'] ); echo $args['before_widget'];  if ( !empty( $title ) ) { echo $args['before_title'] . $title . $args['after_title']; }  $s = cpnl_a("s");  $cpnl_si_f_s = empty($cpnl_o['cpnl_si_f_s']) ? '' : "font-size: ".esc_attr($cpnl_o['cpnl_si_f_s'])."px; ";  $cpnl_si_f_c = empty($cpnl_o['cpnl_si_f_c']) ? '' : "color: ".esc_attr($cpnl_o['cpnl_si_f_c'])."; ";  $cpnl_si_f_w = empty($cpnl_o['cpnl_si_f_w']) ? '' : "font-weight: bold!important; ";  $cpnl_si_ss = ''; if ($cpnl_si_f_s || $cpnl_si_f_c || $cpnl_si_f_w) { $cpnl_si_ss = ' style="'.$cpnl_si_f_s.$cpnl_si_f_c.$cpnl_si_f_w.'" '; }  $cpnl_l = ''; foreach ($s as $ss) {  $sss = explode('-', $ss);  $cpnl_l = $cpnl_l . '<a class="cpnl-mid cpnl-'.$sss[0].'" data-cpnl-mid="'.$sss[0].'" '.$cpnl_si_ss.'>'.$sss[1].'</a><br>'; }  echo __( $cpnl_l, 'cpnl_wd' ); echo $args['after_widget']; } }  public function form($instance) {  if (isset($instance[ 'title' ])) { $title = $instance['title']; } else { $title = __('Filter Coupons By Store', 'cpnl_wd'); }  $w = '<p>'. '<label for="'.esc_attr($this->get_field_id('title')).'">'.esc_html('Title:').'</label>'. '<input class="widefat" id="'.esc_attr($this->get_field_id('title')).'" name="'.esc_attr($this->get_field_name('title')).'" type="text" value="'.esc_attr($title).'" />'. '</p>';  echo $w; }  public function update( $new_instance, $old_instance ) { $instance = array(); $instance['title'] = ( ! empty( $new_instance['title'] ) ) ? strip_tags( $new_instance['title'] ) : ''; return $instance; } }  function cpnl_m_o() {  $cid = $_POST['cid']; $sid = $_POST['sid'];  if ($cid) { $d = cpnl_a('d'); $d = $d[$cid]; $d = base64_decode($d); $data = explode("@@", $d);  $o = $data[0];$r = $data[1];$u = $data[2];$c = $data[3];$s = $data[4];$m = $data[5];$e = $data[6];  if ($sid) { $u = $u.'&sid='.$sid; } $e_u = base64_encode($u);  if ( $r == '0' ) { $r = ''; } else { $r = '<div class="text-left" style="padding-top: 10px; color: #000; font-size: 16px;">Restrictions: <span class="text-danger"><span class="text-warning">'.$r.'</span></div>'; } $j = '<div class="text-center" style="padding: 10px 40px 60px 40px;">'. '<div style="color: #000; font-size: 24px; line-height: 36px;">'.$o.'</div>'. '<div style="padding-top: 40px; color: #000; font-size: 44px; font-weight: bold;">'.$c.'</div>'. '<div style="padding-top: 40px;">'. '<a href="https://go.feeds4.com/coupons/?pid=1276&cid='.$cid.'" class="btn btn-primary btn-lg" style="color: #fff;" target="_blank">Go To '.$s.'</a>'. '</div>'. '<div class="text-left" style="padding-top: 30px; color: #000; font-size: 16px;">Valid Thru: <span class="text-danger">'.$e.'</span></div>'. $r . '</div>'; $json = array('html'=>$j); echo json_encode($json); } die();  } add_action( 'wp_ajax_cpnl_m_o', 'cpnl_m_o' );  function cpnl_w_c_f($cpnl_m_sc_a=null, $cpnl_s_sc_a=null, $cpnl_i_sc_a=null) {  $c = cpnl_a('c');  if ( !is_array($c) ) { return; }  $cpnl_o = get_option('cpnl_o'); $cpnl_i = empty($cpnl_o['cpnl_i']) ? 'n' : $cpnl_o['cpnl_i'];  $id = ''; $cc = '9'; $ic = '3';  if ($cpnl_s_sc_a) { $c = str_ireplace('@@01', 'data-cpnl-sid="'.$cpnl_s_sc_a.'"', $c); } else { $c = str_ireplace('@@01', '', $c); }  if ( $cpnl_i_sc_a == 'hide' || $cpnl_i == 'n' ) { $id = ' style="display: none;"'; $cc = '12'; $ic = '3'; }  $c = str_ireplace('@@11', $id, $c); $c = str_ireplace('@@12', $cc, $c); $c = str_ireplace('@@13', $ic, $c); $c = str_ireplace('@@checkmark', plugin_dir_url( __FILE__ ) . 'img/checkmark.png', $c);  if ($cpnl_m_sc_a) {  $n = 'class="cpnl-'.$cpnl_m_sc_a; $c = array_filter($c, function($h) use($n) { return stripos($h, $n); });  }  $cpnl_content = '';  foreach($c AS $cv) {  $cpnl_content = $cpnl_content . $cv;  }  $cpnl_content = $cpnl_content . '<div class="modal fade" id="cpnl_modal" tabindex="-1" role="dialog">'. '<div class="modal-dialog modal-dialog-centered" role="document">'. '<div class="modal-content" style="border-radius: 0px;">'. '<div class="modal-header" style="border-bottom: 0 none;">'. '<h5 class="modal-title"></h5>'. '<button type="button" class="close" data-dismiss="modal">&times;</button>'. '</div>'. '<div class="modal-body">'. '<div class="modal-data"></div>'. '</div>'. '</div>'. '</div>'. '</div>';  return $cpnl_content;  }  function cpnl_a($a=null) {  $d = empty(get_transient('cpnl_t_k')) ? '' : get_transient('cpnl_t_k');  if (!$d) {  $cpnl_o = get_option('cpnl_o'); $cpnl_t = $cpnl_o['cpnl_t'];  $cpnl_a = cpnl_a_u($cpnl_t);  if (!$cpnl_a) { return; }  $r = wp_remote_get(esc_url_raw($cpnl_a)); $b = wp_remote_retrieve_body($r); $d = json_decode($b, true);  set_transient('cpnl_t_k', $d, 3600);  }  if ($a == "c") { return empty($d['c']) ? '' : $d['c']; } if ($a == "d") { return empty($d['d']) ? '' : $d['d']; } if ($a == "s") { return empty($d['s']) ? '' : $d['s']; }  }  function cpnl_a_u($cpnl_t, $cpnl_d=null) {  $cpnl_o = get_option('cpnl_o'); $cpnl_s = get_option('siteurl');   if ( $cpnl_o && $cpnl_s && $cpnl_t ) {  if ( $cpnl_d ) { $cpnl_v = empty($cpnl_o['cpnl_v']) ? '' : $cpnl_o['cpnl_v'].'/api/'; $cpnl_d = '&d='.$cpnl_d; } else { $cpnl_v = empty($cpnl_o['cpnl_v']) ? '' : $cpnl_o['cpnl_v'].'/'; }  $cpnl_b_u = empty($cpnl_o['cpnl_b_u']) ? '' : $cpnl_o['cpnl_b_u'].'/'; $cpnl_b_v = empty($cpnl_o['cpnl_b_v']) ? '' : $cpnl_o['cpnl_b_v'].'/'; $cpnl_b_d = empty($cpnl_o['cpnl_b_d']) ? '' : $cpnl_o['cpnl_b_d'].'/'; $cpnl_b_p = empty($cpnl_o['cpnl_b_p']) ? '' : $cpnl_o['cpnl_b_p'].'/'; $cpnl_t = '?t='.$cpnl_t; $cpnl_s = '&u='.$cpnl_s;  return $cpnl_b_u.$cpnl_b_v.$cpnl_b_d.$cpnl_b_p.$cpnl_v.$cpnl_t.$cpnl_s.$cpnl_d;  } else {  cpnl_a_n( 'Something went wrong', 'error' ); return;  }  }  function cpnl_a_r($cpnl_a) {  $cpnl_r = wp_remote_get(esc_url_raw($cpnl_a)); $cpnl_b = wp_remote_retrieve_body($cpnl_r); $cpnl_j = json_decode($cpnl_b, true); $cpnl_d = empty($cpnl_j['d']) ? '' : $cpnl_j['d'];  if (!$cpnl_d) { cpnl_a_n( 'The api returned an error.  Please contact Feeds4 Support.', 'error' ); return; }  return $cpnl_d;  }  function cpnl_f_t($cpnl_tabs) {  if (!empty($_POST)) {  $cpnl_t = sanitize_text_field($_POST['cpnl_t']);  if (!$cpnl_t) { cpnl_a_n( 'No token was entered.  Please try again.', 'error' ); return; }  $cpnl_o = get_option('cpnl_o'); $cpnl_n = $cpnl_o['cpnl_n'];  $cpnl_a = cpnl_a_u($cpnl_t, 'token');  $d = cpnl_a_r($cpnl_a);  if (!$d) { cpnl_a_n( 'The token api response produced an error.  Please contact Feeds4 Support.', 'error' ); return; }  foreach ($d as $key => $value) {  unset($k, $v);  $k = sanitize_text_field($key); $v = sanitize_text_field($value);  if ( $k == 'cpnl_e' ) { cpnl_a_n( $v, 'error' ); return; }  if (!$k) { continue; }  if ( array_key_exists('cpnl_t', $cpnl_o) === false && $k == 'cpnl_t' ) { echo cpnl_a_t($cpnl_tabs); }  if ( array_key_exists($k, $cpnl_o) === true ) { continue; } else { $cpnl_o[$k] = $v; }  }  cpnl_d_t_k();  update_option('cpnl_o', $cpnl_o);  cpnl_a_n( 'Congrats!  Your api token was saved successfully.  You are now ready to use the '.$cpnl_n.' plugin.', 'updated' );  }  }  function cpnl_e_t() {  $cpnl_o = get_option('cpnl_o'); $cpnl_n = $cpnl_o["cpnl_n"];  $t = empty($cpnl_o["cpnl_t"]) ? '' : esc_attr($cpnl_o["cpnl_t"]); $v1 = __('Enter Your Feeds4 API Token'); $v2 = __('Your API token is available in the Feeds4 publisher portal'); $v3 = __('Save Changes'); $v4 = __('Feeds4 Publisher Portal'); $v5 = __('Get Your API Token'); $v6 = __('Manage Account Settings'); $v7 = __('Add or Remove Merchants'); $v8 = __('View Earnings'); $v9 = __('Contact Support'); $v10 = __('Upgrade Your Account'); $v11 = esc_url_raw('https://publishers.feeds4.com'); $v12 = __('Publisher Login'); $v13 = __('Like The Plugin?'); $v14 = __('We would love a 5-star rating at Wordpress.org to help us spread the word.'); $v15 = esc_url_raw('https://wordpress.org/support/plugin/couponpanel/reviews/'); $v16 = __('Rate '.$cpnl_n); $v17 = esc_url_raw('https://publishers.feeds4.com/couponpanel/'); $v18 = __('Publisher Sign-Up');  echo ' <div class="cpnl-body-inside"> <div class="main_column"> <div class="metabox-holder"> <div class="postbox"> <form method="post"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v1.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl-form-input" type="text" name="cpnl_t" value="'.$t.'"> </div> <div class="cpnl-mt10" style="padding-top: 10px;"> '.$v2.' </div> </div> <div class="cpnl-button"> <input type="submit" class="cpnl-btn cpnl-primary" value="'.$v3.'"> </div> </form> </div> </div> </div> <div class="inner_wrapper"> <div class="metabox-holder"> <div class="postbox"> <div class="cpnl-input cpnl-form-label-big"> '.$v4.' </div> <div class="cpnl-input"> <li>'.$v5.'</li> <li>'.$v6.'</li> <li>'.$v7.'</li> <li>'.$v8.'</li> <li>'.$v9.'</li> <li>'.$v10.'</li> </div> <div class="cpnl-button"> <a href="'.$v17.'" target="_blank"> <button class="cpnl-btn cpnl-danger" style="width: 100%;"> '.$v18.' </button> </a> </div> <div class="cpnl-button"> <a href="'.$v11.'" target="_blank"> <button class="cpnl-btn cpnl-primary" style="width: 100%;"> '.$v12.' </button> </a> </div> </div> </div> <div class="metabox-holder" style="margin-top: -15px;"> <div class="postbox"> <div class="cpnl-input cpnl-form-label-big"> '.$v13.' </div> <div class="cpnl-input"> '.$v14.' </div> <div class="cpnl-button"> <a href="'.$v15.'" target="_blank"> <button class="cpnl-btn cpnl-success"> '.$v16.' </button> </a> </div> </div> </div> </div> </div>';  }  function cpnl_f_s() {  $cpnl_o = get_option('cpnl_o');  unset( $cpnl_o["cpnl_s_p_b"] );  if (!empty($_POST)) {  $p = '';  foreach($_POST as $k => $v) {  $k = sanitize_text_field($k); $v = sanitize_text_field($v);  if (!$k) { continue; }  if ( $k == 'cpnl_c_c_t' && !$v ) { $v = 'Coupon Code'; } if ( $k == 'cpnl_c_d_t' && !$v ) { $v = 'Expires'; }  $cpnl_o[$k] = $v;  $p = $p.'&'.$k.'='.$v; $p = str_replace('#', '', $p);  }  update_option('cpnl_o', $cpnl_o);  if ($p) {  $cpnl_t = empty($cpnl_o['cpnl_t']) ? '' : $cpnl_o['cpnl_t']; $cpnl_a = cpnl_a_u($cpnl_t, 'settings');  $d = cpnl_a_r($cpnl_a.$p);  if (!$d) { cpnl_a_n( 'The was a problem saving your settings, please try again or contact Feeds4 Support if you are still having issues.', 'error' ); return; }  foreach ($d as $k => $v) {  if ( $k == 'cpnl_e' ) {  cpnl_a_n( 'The was a problem saving your settings, please try again or contact Feeds4 Support if you are still having issues.', 'error' ); return;  }  }  }  cpnl_d_t_k();  cpnl_a_n( 'Custom Settings Saved', 'updated' );  }  }  function cpnl_e_s() {  $cpnl_o = get_option('cpnl_o'); $cpnl_n = $cpnl_o['cpnl_n'];  $al = empty($cpnl_o['cpnl_s_p_b']) ? '' : checked( 'y', $cpnl_o['cpnl_s_p_b'], false);  $g1 = empty($cpnl_o['cpnl_c_c_t']) ? '' : esc_attr($cpnl_o['cpnl_c_c_t']); $g2 = empty($cpnl_o['cpnl_c_d_t']) ? '' : esc_attr($cpnl_o['cpnl_c_d_t']);  $v1 = __('Set Coupon Code Button Text:'); $v2 = __('Example: Entering the words "Show Promo Code" will display "Show Promo Code" on the button when a coupon code is required.'); $v3 = __('Set Expiration Date Text:'); $v4 = __('Example: Entering the words "Valid Thru" will show "Valid Thru:" before the expiration date in the coupon box.'); $v5 = __($cpnl_n . ' Plugin Attribution:'); $v6 = __('Show attribution link at bottom of coupon list'); $v7 = __('Check this box if you want to help us promote our plugin.  When selected a link will be placed at the end of the coupon list "Powered by '.$cpnl_n.'".  We really appreciate publishers who set this.'); $v8 = __('Save Changes');  echo ' <div class="metabox-holder"> <div class="postbox"> <form method="post"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v1.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl-form-input mr20" type="text" name="cpnl_c_c_t" value="'.$g1.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v2.' </div> </div> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v3.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl-form-input" type="text" name="cpnl_c_d_t" value="'.$g2.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v4.' </div> </div> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v5.'</b> </label> <div class="cpnl-mt10"> <input name="cpnl_s_p_b" type="checkbox" value="y" '.$al.'> '.$v6.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v7.' </div> </div> <div class="cpnl-button"> <input type="submit" class="cpnl-btn cpnl-primary" value="'.$v8.'"> </div> </form> </div> </div>';  }  function cpnl_f_l() {  $cpnl_o = get_option('cpnl_o');  if (!empty($_POST)) {  $p = '';  foreach($_POST as $k => $v) {  $k = sanitize_text_field($k); $v = sanitize_text_field($v);  if (!$k) { continue; }  if ( $k == 'cpnl_c_lo' && !$v ) { $v = 'l1'; }  $cpnl_o[$k] = $v;  $p = $p.'&'.$k.'='.$v; $p = str_replace('#', '', $p);  }  update_option('cpnl_o', $cpnl_o);  if ($p) {  $cpnl_t = empty($cpnl_o['cpnl_t']) ? '' : $cpnl_o['cpnl_t']; $cpnl_a = cpnl_a_u($cpnl_t, 'layout');  $d = cpnl_a_r($cpnl_a.$p);  if (!$d) { cpnl_a_n( 'The was a problem saving your layout, please try again or contact Feeds4 Support if you are still having issues.', 'error' ); return; }  foreach ($d as $k => $v) {  if ( $k == 'cpnl_e' ) {  cpnl_a_n( 'The was a problem saving your layout, please try again or contact Feeds4 Support if you are still having issues.', 'error' ); return;  }  }  }  cpnl_d_t_k();  cpnl_a_n( 'Custom Settings Saved', 'updated' );  }  }  function cpnl_e_l() {  $cpnl_o = get_option('cpnl_o');  $l1 = empty($cpnl_o['cpnl_c_lo']) ? '' : checked( 'l1', $cpnl_o['cpnl_c_lo'], false); $l2 = empty($cpnl_o['cpnl_c_lo']) ? '' : checked( 'l2', $cpnl_o['cpnl_c_lo'], false); $l3 = empty($cpnl_o['cpnl_c_lo']) ? '' : checked( 'l3', $cpnl_o['cpnl_c_lo'], false);  $c1 = $cpnl_o['cpnl_c_lo'] == 'l1' ? '' : 'display: none;'; $c2 = $cpnl_o['cpnl_c_lo'] == 'l2' ? '' : 'display: none;'; $c3 = $cpnl_o['cpnl_c_lo'] == 'l3' ? '' : 'display: none;';  $v1 = __('Choose a coupon layout.'); $v2 = plugins_url('/img/layout_'.$cpnl_o['cpnl_c_lo'].'.png', __FILE__); $v3 = plugins_url('/img/', __FILE__); $v4 = __('Coupon List Layout: Default'); $v5 = plugins_url('/img/', __FILE__); $v6 = __('Coupon List Layout: Badger'); $v7 = plugins_url('/img/', __FILE__); $v8 = __('Coupon List Layout: Minimalist'); $v9 = __('Save Changes');  echo ' <div class="metabox-holder"> <div class="postbox"> <form method="post"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v1.'</b> </label> <div class="cpnl-mt20" style="overflow: hidden;"> <img id="cpnl_layout_preview" style="max-width: 728px;" src="'.$v2.'"> </div> <div class="cpnl-input"> <div class="cpnl-mt10"> <input name="cpnl_c_lo" type="radio" value="l1" data-url="'.$v3.'" '.$l1.'> '.$v4.' <div class="cpnl_layout cpnl_layout_1 cpnl-mt10 cpnl-pl30" style="'.$c1.'"> </div> </div> <div class="cpnl-mt10"> <input name="cpnl_c_lo" type="radio" value="l2" data-url="'.$v5.'" '.$l2.'> '.$v6.' <div class="cpnl_layout cpnl_layout_2 cpnl-mt10 cpnl-pl20" style="'.$c2.'"> </div> </div> <div class="cpnl-mt10"> <input name="cpnl_c_lo" type="radio" value="l3" data-url="'.$v7.'" '.$l3.'> '.$v8.' <div class="cpnl_layout cpnl_layout_3 cpnl-mt10 cpnl-pl30" style="'.$c3.'"> </div> </div> </div> </div> <div class="cpnl-button"> <input type="submit" class="cpnl-btn cpnl-primary" value="'.$v9.'"> </div> </form> </div> </div>';  }  function cpnl_f_st() {  $cpnl_o = get_option('cpnl_o');  unset( $cpnl_o['cpnl_c_f_w'], $cpnl_o['cpnl_d_f_w'], $cpnl_o['cpnl_t_f_w'], $cpnl_o['cpnl_st_f_w'], $cpnl_o['cpnl_c_b_d_s'], $cpnl_o['cpnl_si_f_w'], $cpnl_o['cpnl_o_b_f_w'], );  if (!empty($_POST)) {  $p = '';  foreach($_POST as $k => $v) {  $k = sanitize_text_field($k); $v = sanitize_text_field($v);  if (!$k) { continue; }  $cpnl_o[$k] = $v;  $p = $p.'&'.$k.'='.$v; $p = str_replace('#', '', $p);  }  update_option('cpnl_o', $cpnl_o);  if ($p) {  $cpnl_t = empty($cpnl_o['cpnl_t']) ? '' : $cpnl_o['cpnl_t']; $cpnl_a = cpnl_a_u($cpnl_t, 'style');  $d = cpnl_a_r($cpnl_a.$p);  if (!$d) { cpnl_a_n( 'The was a problem saving your styles, please try again or contact Feeds4 Support if you are still having issues.', 'error' ); return; }  foreach ($d as $k => $v) {  if ( $k == 'cpnl_e' ) {  cpnl_a_n( 'The was a problem saving your styles, please try again or contact Feeds4 Support if you are still having issues.', 'error' ); return;  }  }  }  cpnl_d_t_k();  cpnl_a_n( 'Style Settings Saved', 'updated' );  }  }  function cpnl_e_st() {  $cpnl_o = get_option('cpnl_o');  $c1 = empty($cpnl_o['cpnl_si_f_w']) ? '' : checked( 'b', $cpnl_o['cpnl_si_f_w'], false); $c2 = empty($cpnl_o['cpnl_c_b_d_s']) ? '' : checked( 'y', $cpnl_o['cpnl_c_b_d_s'], false); $c3 = empty($cpnl_o['cpnl_st_f_w']) ? '' : checked( 'b', $cpnl_o['cpnl_st_f_w'], false); $c4 = empty($cpnl_o['cpnl_t_f_w']) ? '' : checked( 'b', $cpnl_o['cpnl_t_f_w'], false); $c5 = empty($cpnl_o['cpnl_d_f_w']) ? '' : checked( 'b', $cpnl_o['cpnl_d_f_w'], false); $c6 = empty($cpnl_o['cpnl_o_b_f_w']) ? '' : checked( 'b', $cpnl_o['cpnl_o_b_f_w'], false);  $g1 = empty($cpnl_o['cpnl_si_f_s']) ? '' : esc_attr($cpnl_o['cpnl_si_f_s']); $g2 = empty($cpnl_o['cpnl_si_f_c']) ? '' : esc_attr($cpnl_o['cpnl_si_f_c']); $g3 = empty($cpnl_o['cpnl_c_b_s']) ? '' : esc_attr($cpnl_o['cpnl_c_b_s']); $g4 = empty($cpnl_o['cpnl_c_b_c']) ? '' : esc_attr($cpnl_o['cpnl_c_b_c']); $g5 = empty($cpnl_o['cpnl_c_b_r']) ? '' : esc_attr($cpnl_o['cpnl_c_b_r']); $g6 = empty($cpnl_o['cpnl_st_f_s']) ? '' : esc_attr($cpnl_o['cpnl_st_f_s']); $g7 = empty($cpnl_o['cpnl_st_f_c']) ? '' : esc_attr($cpnl_o['cpnl_st_f_c']); $g8 = empty($cpnl_o['cpnl_t_f_s']) ? '' : esc_attr($cpnl_o['cpnl_t_f_s']); $g9 = empty($cpnl_o['cpnl_t_f_c']) ? '' : esc_attr($cpnl_o['cpnl_t_f_c']); $g10 = empty($cpnl_o['cpnl_d_f_s']) ? '' : esc_attr($cpnl_o['cpnl_d_f_s']); $g11 = empty($cpnl_o['cpnl_d_f_c']) ? '' : esc_attr($cpnl_o['cpnl_d_f_c']); $g12 = empty($cpnl_o['cpnl_o_b_c']) ? '' : esc_attr($cpnl_o['cpnl_o_b_c']); $g13 = empty($cpnl_o['cpnl_o_b_b_r']) ? '' : esc_attr($cpnl_o['cpnl_o_b_b_r']); $g14 = empty($cpnl_o['cpnl_o_b_b_s']) ? '' : esc_attr($cpnl_o['cpnl_o_b_b_s']); $g15 = empty($cpnl_o['cpnl_o_b_b_c']) ? '' : esc_attr($cpnl_o['cpnl_o_b_b_c']); $g16 = empty($cpnl_o['cpnl_o_b_f_s']) ? '' : esc_attr($cpnl_o['cpnl_o_b_f_s']); $g17 = empty($cpnl_o['cpnl_o_b_f_c']) ? '' : esc_attr($cpnl_o['cpnl_o_b_f_c']);  $v1 = __('Sidebar Widget'); $v2 = __('Sidebar Merchant Name Font Size'); $v4 = __('Sets the font size for merchant names in the sidebar widget.  All values will be in pixels. The higher the number the bigger the font.'); $v5 = __('Sidebar Merchant Name Font Color'); $v6 = __('Sets the font color for merchant names in the sidebar widget.'); $v7 = __('Sidebar Merchant Name Font Weight'); $v8 = __('Bold Text'); $v9 = __('Sets the font weight (normal or bold) for merchant names in the sidebar widget.'); $v10 = __('Coupon Box Border'); $v11 = __('Coupon Box Border Thickness'); $v12 = __('Sets a custom coupon box border thickness. All values will be in pixels.  The higher the number the thicker the border.  Enter 0 or leave blank for no border.'); $v13 = __('Coupon Box Border Color'); $v14 = __('Sets a custom coupon box border color.'); $v15 = __('Coupon Box Border Radius'); $v16 = __('Sets a custom coupon box border radius.  All values will be in pixels.  The higher the number the more rounded the corners.  Enter 0 or leave blank for a square border.'); $v17 = __('Coupon Box Drop Shadow'); $v18 = __('Show Drop Shadow'); $v19 = __('Adds a border drop shadow to each coupon box.'); $v20 = __('Store Name Font'); $v21 = __('Merchant Name Font Size'); $v22 = __('Sets the merchant name font size in the coupon list.  All values will be in pixels.  The higher the number the bigger the font.'); $v23 = __('Merchant Name Font Color'); $v24 = __('Sets the merchant name font color in the coupon list.'); $v25 = __('Merchant Name Font Weight'); $v26 = __('Sets the merchant name font weight in the coupon list.'); $v27 = __('Coupon Title Font'); $v28 = __('Coupon Title Font Size'); $v29 = __('Sets the coupon title font size in the coupon list.  All values will be in pixels.  The higher the number the bigger the font.'); $v30 = __('Coupon Title Font Color'); $v31 = __('Sets the coupon title font color in the coupon list.'); $v32 = __('Coupon Title Font Weight'); $v33 = __('Sets the coupon title font weight (normal or bold) in the coupon list.'); $v34 = __('Expiration Date Font'); $v35 = __('Coupon Expiration Date Font Size'); $v36 = __('Sets the coupon expiration date font size for the coupon expiration date.  All values will be in pixels.  The higher the number the bigger the font.'); $v37 = __('Coupon Expiration Date Font Color'); $v38 = __('Sets the coupon expiration date font color for the coupon expiration date.'); $v39 = __('Coupon Expiration Date Font Weight'); $v40 = __('Sets the coupon expiration date font weight for the coupon expiration date.'); $v41 = __('Coupon Button'); $v42 = __('Coupon Button Color:'); $v43 = __('Sets a custom color for the coupon button.'); $v44 = __('Coupon Button Border Radius:'); $v45 = __('Sets a custom border radius for the coupon button.  All values will be in pixels.  The higher the number the more rounded the corners. Enter 0 or leave blank for a square border.'); $v46 = __('Coupon Button Border Size:'); $v47 = __('Sets a custom border thickness for the coupon button.  All values will be in pixels.  The higher the number the thicker the border.  Enter 0 or leave blank for no border.'); $v48 = __('Coupon Button Border Color:'); $v49 = __('Sets a custom border color for the coupon button.'); $v50 = __('Coupon Button Font Size'); $v51 = __('Sets the coupon button font size.  All values will be in pixels.  The higher the number the bigger the font.'); $v52 = __('Coupon Button Font Color'); $v53 = __('Sets the coupon button font color.'); $v54 = __('Coupon Button Font Weight'); $v55 = __('Sets the coupon button font weight.'); $v56 = __('Save Configuration');  $ni = empty($cpnl_o['cpnl_i']) ? '' : checked( 'n', $cpnl_o['cpnl_i'], false ); $li = empty($cpnl_o['cpnl_i']) ? '' : checked( 'l', $cpnl_o['cpnl_i'], false ); $ti = empty($cpnl_o['cpnl_i']) ? '' : checked( 't', $cpnl_o['cpnl_i'], false );  $si1 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '1', $cpnl_o['cpnl_i_st'], false ); $si2 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '2', $cpnl_o['cpnl_i_st'], false ); $si3 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '3', $cpnl_o['cpnl_i_st'], false ); $si4 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '4', $cpnl_o['cpnl_i_st'], false ); $si5 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '5', $cpnl_o['cpnl_i_st'], false ); $si6 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '6', $cpnl_o['cpnl_i_st'], false ); $si7 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '7', $cpnl_o['cpnl_i_st'], false ); $si8 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '8', $cpnl_o['cpnl_i_st'], false ); $si9 = empty($cpnl_o['cpnl_i_st']) ? '' : checked( '9', $cpnl_o['cpnl_i_st'], false );  $gi1 = empty($cpnl_o['cpnl_i_b_s']) ? '' : esc_attr($cpnl_o['cpnl_i_b_s']); $gi2 = empty($cpnl_o['cpnl_i_b_c']) ? '' : esc_attr($cpnl_o['cpnl_i_b_c']);  $ci1 = $cpnl_o['cpnl_i'] != 'n' ? '' : 'display: none;';  $vi1 = __('Images'); $vi2 = __('No Image'); $vi3 = __('Merchant Logo'); $vi4 = __('Website Thumbnail'); $vi5 = __('Select a preferred style for your images.'); $vi6 = __('Rectangle Small'); $vi7 = __('Rectangle Med'); $vi8 = __('Rectangle Large'); $vi9 = __('Circle Small'); $vi10 = __('Circle Med'); $vi11 = __('Circle Large'); $vi12 = __('Square Small'); $vi13 = __('Square Med'); $vi14 = __('Square Large'); $vi15 = __('Set a custom image border thickness.'); $vi16 = __('px'); $vi17 = __('All values will be in pixels.  The higher the number the thicker the border.  Enter 0 or leave blank for no border.'); $vi18 = __('Set a custom image border color.'); $vi19 = __('Save Changes'); $vi20 = __('Select an image type.');  echo ' <div class="metabox-holder"> <div class="postbox"> <form method="post"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$vi1.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$vi20.'</b> </label> <div class="cpnl-mt10"><input name="cpnl_i" type="radio" value="n" '.$ni.'>'.$vi2.'</div> <div class="cpnl-mt10"><input name="cpnl_i" type="radio" value="l" '.$li.'>'.$vi3.'</div> <div class="cpnl-mt10"><input name="cpnl_i" type="radio" value="t" '.$ti.'>'.$vi4.'</div> </div> <div id="cpnl_i" style="'.$ci1.'"> <div class="cpnl-input" style="padding: 10px 40px;"> <label class="cpnl-form-label cpnl-mt10"> <b>'.$vi5.'</b> </label> <div class="cpnl-mt10"> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="1" '.$si1.'>'.$vi6.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="2" '.$si2.'>'.$vi7.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="3" '.$si3.'>'.$vi8.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="4" '.$si4.'>'.$vi9.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="5" '.$si5.'>'.$vi10.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="6" '.$si6.'>'.$vi11.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="7" '.$si7.'>'.$vi12.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="8" '.$si8.'>'.$vi13.'</div> <div class="cpnl-mt10"><input name="cpnl_i_st" type="radio" value="9" '.$si9.'>'.$vi14.'</div> </div> <label class="cpnl-form-label cpnl-mt10"> <b>'.$vi15.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_i_b_s" value="'.$gi1.'"> '.$vi16.' </div> <div class="cpnl-mt10 cpnl-small"> '.$vi17.' </div> <label class="cpnl-form-label cpnl-mt10"> <b>'.$vi18.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl-form-input cpnl_wcp" type="text" name="cpnl_i_b_c" value="'.$gi2.'"> </div> </div> </div> <hr class="cpnl-mt20">  <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v1.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$v2.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_si_f_s" value="'.$g1.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v4.' </div> <label class="cpnl-form-label cpnl-mt10"> <b>'.$v5.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_si_f_c" value="'.$g2.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v6.' </div> <label class="cpnl-form-label cpnl-mt10"> <b>'.$v7.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_check" style="margin-left: 5px;" name="cpnl_si_f_w" type="checkbox" value="b" '.$c1.'> '.$v8.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v9.' </div> </div> <hr class="cpnl-mt20">  <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v10.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$v11.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_c_b_s" value="'.$g3.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v12.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v13.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_c_b_c" value="'.$g4.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v14.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v15.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_c_b_r" value="'.$g5.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v16.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v17.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_check" style="margin-left: 5px;" name="cpnl_c_b_d_s" type="checkbox" value="y" '.$c2.'> '.$v18.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v19.' </div> </div> <hr class="cpnl-mt20"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v20.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$v21.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_st_f_s" value="'.$g6.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v22.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v23.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_st_f_c" value="'.$g7.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v24.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v25.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_check" style="margin-left: 5px;" name="cpnl_st_f_w" type="checkbox" value="b" '.$c3.'> '.$v8.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v26.' </div> </div> <hr class="cpnl-mt20"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v27.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$v28.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_t_f_s" value="'.$g8.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v29.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v30.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_t_f_c" value="'.$g9.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v31.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v32.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_check" style="margin-left: 5px;" name="cpnl_t_f_w" type="checkbox" value="b" '.$c4.'> '.$v8.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v33.' </div> </div> <hr class="cpnl-mt20"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v34.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$v35.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_d_f_s" value="'.$g10.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v36.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v37.'</b> </label> <div class="ccpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_d_f_c" value="'.$g11.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v38.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v39.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_check" style="margin-left: 5px;" name="cpnl_d_f_w" type="checkbox" value="b" '.$c5.'> '.$v8.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v40.' </div> </div> <hr class="cpnl-mt20"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v41.'</b> </label> </div> <div class="cpnl-input" style="padding: 0 20px;"> <label class="cpnl-form-label"> <b>'.$v42.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_o_b_c" value="'.$g12.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v43.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v44.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_o_b_b_r" value="'.$g13.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v45.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v46.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_o_b_b_s" value="'.$g14.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v47.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v48.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_o_b_b_c" value="'.$g15.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v49.' </div> <label class="cpnl-form-label"> <b>'.$v50.'</b> </label> <div class="cpnl-mt10"> <input size="5" type="text" name="cpnl_o_b_f_s" value="'.$g16.'"> px </div> <div class="cpnl-mt10 cpnl-small"> '.$v51.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v52.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_wcp" type="text" name="cpnl_o_b_f_c" value="'.$g17.'"> </div> <div class="cpnl-mt10 cpnl-small"> '.$v53.' </div> <label class="cpnl-mt10 cpnl-form-label"> <b>'.$v54.'</b> </label> <div class="cpnl-mt10"> <input class="cpnl_check" style="margin-left: 5px;" name="cpnl_o_b_f_w" type="checkbox" value="b" '.$c6.'> '.$v8.' </div> <div class="cpnl-mt10 cpnl-small"> '.$v55.' </div> </div> <hr class="cpnl-mt20"> <div class="cpnl-button"> <input type="submit" class="cpnl-btn cpnl-primary" value="'.$v56.'"> </div> </form> </div> </div>'; }  function cpnl_f_sc() {  $d = get_transient('cpnl_t_k');  if (!$d) { return; }  $s = empty($d['s']) ? '' : $d['s'];  if (!$s) { return; }  array_pop($s);  $sc = ''; foreach( $s as $ss ) { $sss = explode('-', $ss); $sc = $sc . '<div class="cpnl-pl20"><span class="cpnl-shortcode">[couponpanel merchant="'.$sss[0].'"]</span> - '.$sss[1].'</div>'; }  return $sc; }  function cpnl_e_sc() {  $cpnl_o = get_option('cpnl_o'); $cpnl_n = $cpnl_o["cpnl_n"];  $v1 = __('Default'); $v2 = __('Use the following shortcode to add a list of coupons to any page on your website.'); $v3 = __(''); $v4 = __('Individual Merchants'); $v5 = __('Use the following shortcodes to add coupons for individual merchants to any page or post.'); $v6 = __('Sub-Ids'); $v7 = __('You can add sub ids to your shortcode for click or commission tracking.'); $v8 = __('Use the following shortcode to add coupons to any page with a unique tracking id.  The unique tracking id in the following example is '); $v9 = __(''); $v10 = __('.  You can replace '); $v11 = __('with any alpha-numeric string plus hyphens up to 50 characters in length.  Tracking ids are sent to the affiliate networks we work with and allow you to associate commissions earned to the sub id.'); $v12 = __('Why Use Sub Ids?'); $v13 = __('Sub Ids allow you to track what pages your clicks/conversions are coming from.  For example, if you place the following shortcode on your coupons page:'); $v14 = __('Images'); $v15 = __('You can override the '.$cpnl_n.' image settings per shortcode if you want to show or hide images for specific area on your site.'); $v16 = __('Then you place the following shortcode in a post where you review the merchant "Macy\'s" and show Macy\'s specific promotions:'); $v17 = __('displays images'); $v18 = __('If a coupon is clicked from the coupons page, you will see the sub id, "coupons-page" in your reports.  If any commissions earned have the sub id "macys-review-post", you will know what page the click came from and have a better idea as to what content motivates your customers to purchase items.'); $v19 = __('hides images');  echo ' <div class="metabox-holder"> <div class="postbox"> <div class="cpnl-input"> <label class="cpnl-form-label"> <b>'.$v1.'</b> </label> <label class="cpnl-mt10 cpnl-form-label"> '.$v2.' </label> <div class="cpnl-mt10"> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel]</span> </div> </div> </div> <div class="cpnl-input cpnl-mt20"> <label class="cpnl-form-label"> <b>'.$v4.'</b> </label> <label class="cpnl-mt10 cpnl-form-label"> '.$v5.' </label> <div class="cpnl-mt10"> '.cpnl_f_sc().' </div> </div> <div class="cpnl-input cpnl-mt20"> <label class="cpnl-form-label"> <b>'.$v6.'</b> </label> <label class="cpnl-mt10 cpnl-form-label"> '.$v7.' </label> <label class="cpnl-mt10 cpnl-form-label"> '.$v8.' <span style="color: red; font-weight: bold;">123</span> '.$v10.' <span style="color: red; font-weight: bold;">123</span> '.$v11.' </label> <div class="cpnl-mt10"> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel subid="<span style="color: red; font-weight: bold;">123</span>"]</span> </div> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel merchant="11111" subid="<span style="color: red; font-weight: bold;">123</span>"]</span> </div> </div> </div> <div class="cpnl-input cpnl-mt20"> <label class="cpnl-form-label"> <b>'.$v12.'</b> </label> <label class="cpnl-mt10 cpnl-form-label"> '.$v13.' </label> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel subid="<span style="color: red; font-weight: bold;">coupons-page</span>"]</span> </div> <label class="cpnl-mt10 cpnl-form-label"> '.$v16.' </label> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel merchant="11111" subid="<span style="color: red; font-weight: bold;">macys-review-post</span>"]</span> </div> <label class="cpnl-mt10 cpnl-form-label"> '.$v18.' </label>  </div> <div class="cpnl-input cpnl-mt20"> <label class="cpnl-form-label"> <b>'.$v14.'</b> </label> <label class="cpnl-mt10 cpnl-form-label"> '.$v15.' </label> <div class="cpnl-mt10"> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel merchant="11111" image="<span style="color: red">show</span>"]</span> - '.$v17.' </div> <div class="cpnl-pl20"> <span class="cpnl-shortcode">[couponpanel merchant="11111" image="<span style="color: red">hide</span>"]</span> - '.$v19.' </div> </div> </div> </div> </div>';  }  function cpnl_a_p() {  global $pagenow;  $page = ''; if ( isset($_GET['page']) ) { $page = $_GET['page']; }  if ( $pagenow == 'admin.php' && $page == 'cpnl_admin' ) {  $cpnl_o = get_option('cpnl_o');  $cpnl_tabs = array( 'token' => 'Token', 'settings' => 'Settings', 'layout' => 'Layout', 'style' => 'Style', 'shortcode' => 'Shortcodes', ); ?> <div> <div id="cpnl-plugin-container"> <div> <div class="cpnl-masthead"> <div class="cpnl-masthead-inside"> <h2><?php echo esc_html( $cpnl_o["cpnl_n"].' v. '.$cpnl_o["cpnl_v"] ); ?></h2> </div> </div> <div class="cpnl-body" style="padding-bottom: 30px;"> <div class="wrap"> <h2></h2> <?php if ( array_key_exists('cpnl_t', $cpnl_o) === true ) { echo cpnl_a_t($cpnl_tabs); }  $cpnl_tab = '';  if ( isset($_GET['tab']) ) { $cpnl_tab = $_GET['tab']; }  $cpnl_tab = cpnl_v_t($cpnl_tab);  switch($cpnl_tab) {  case 'token' : cpnl_f_t($cpnl_tabs); cpnl_e_t(); break;  case 'settings' : cpnl_f_s(); cpnl_e_s(); break;  case 'layout' : cpnl_f_l(); cpnl_e_l(); break;  case 'style' : cpnl_f_st(); cpnl_e_st(); break;  case 'shortcode' : cpnl_w_c_f(); cpnl_e_sc(); break; } ?> </div> </div> <div class="cpnl-footer"> &nbsp; </div> </div> </div> </div> <?php } }